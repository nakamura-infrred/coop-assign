# マスターデータ閲覧（Phase 1）まとめ

## 実装概要

- Firestore の `tenants/{tenantId}/teams` / `venues` から、チームと会場のマスタを読み込み表示する UI を追加しました。
- `MasterDataProvider` が一括でマスタを取得し、`MasterDataPreview` コンポーネントで一覧・検索・件数表示を行います。
- ID はすべて 16 文字のハッシュ（`SHA-1` 先頭 16 桁）で生成され、Firestore のドキュメント ID と一致します。
- `pnpm seed:prepare` → `pnpm seed:push` でマスタを再生成・再投入できます（詳細は `docs/firestore-seeds.md` を参照）。
- テナントは `VITE_DEFAULT_TENANT_ID` が空の場合でも自動的に `default` を利用するようにしました。

## 画面仕様（2025-10 時点）

- 表示ビューは「チーム / 会場」をトグルで切り替え。
- **チームビュー**
  - 列: 名称 / 区分（大学・社会人など）/ 地域 / リーグ
  - 区分・地域・リーグで絞り込み、名称検索（日本語対応）に対応
  - 20 件ずつ表示し「他 N 件を表示」で追加ロード
- **会場ビュー**
  - 列: 名称 / 種別（グラウンド・球場など）/ 地域
  - 種別・地域フィルタと名称検索に対応
  - チーム同様、段階的な表示（20 件単位）
- データ未登録時は空表示のメッセージを表示
- Firestore 取得エラー時は `マスターデータの取得に失敗しました。` を表示

## 今後の拡張方針（Phase 2 以降）

- チーム／会場／審判マスタの編集（追加・更新・削除）UI を段階導入する
- カテゴリ／地域／リーグなどでの高度なフィルタリング・ソートを追加する
- 審判マスタ、役割マスタ、シーズンマスタなどの追加実装
- CSV / JSON インポート・エクスポート機能（運用向け）
- 会場に住所・緯度経度を追加し、審判所在地とのマッチングに活用する

## 既知の制限

- 編集機能は未実装。現在は Firestore 直編集またはシード投入が必要。
- 取得は一括ロードのため、データ数が大きい場合はページング API やサーバーサイド フィルタへの対応が必要になる。
- ハッシュ ID は重複が極めて起きにくいが、完全に衝突しないことを保証するものではない（必要なら衝突検出を追加）。

Phase 1 は「マスターデータを UI 上で参照できる」状態をゴールとし、本ドキュメントにまとめました。次フェーズでは本ドキュメントの「今後の拡張方針」を起点に実装を進めてください。

## 可用性入力 UI プロトタイプ（参考）

- `AvailabilityPreview` コンポーネントで、審判マスタを五十音順に並べた月次グリッドを試験表示しています。
- 対象月の列数は自動調整され、セルをクリックすると `○ / △ / ▽` をローテーション表示します（ローカル状態のみ）。
- 土曜日（青）・日曜祝日（赤）で列を色分けし、表示する曜日／祝日をトグルで切り替えられるため、紙面の列数を絞って確認できます。
- 印刷スタイルを定義しており、ブラウザの印刷ダイアログから紙面レイアウトを確認できます。
- 本プロトタイプは可用性データの保存までは行わず、紙運用からの移行イメージ共有を目的としています。
